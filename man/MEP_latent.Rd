% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MEP.R
\name{MEP_latent}
\alias{MEP_latent}
\title{Metropolis–Hastings sampler for MEP-regularized logistic regression}
\usage{
MEP_latent(
  n_iter,
  init_beta,
  step_size,
  X_orig,
  y,
  mu,
  Sigma,
  kappa,
  burn_in = 1000,
  scale_X = TRUE,
  ci_level = 0.95
)
}
\arguments{
\item{n_iter}{Integer. Total MCMC iterations (including burn-in).}

\item{init_beta}{Numeric vector of length \eqn{p} (intercept + predictors).
Starting values for the chain.}

\item{step_size}{Numeric. Proposal step-size (RW–MH standard deviation).}

\item{X_orig}{Matrix or data.frame of predictors (no intercept), \eqn{n \times (p-1)}.}

\item{y}{Binary outcome of length \eqn{n} (0/1, logical, or 2-level factor/character).}

\item{mu}{Numeric vector of length \eqn{p}. Prior location for the MEP prior (includes intercept).}

\item{Sigma}{Positive-definite \eqn{p \times p} matrix. Prior scale for the MEP prior.}

\item{kappa}{Positive numeric. Shape of the MEP prior; \eqn{\kappa = 1} resembles Laplace-like
tails, larger values approach Gaussian.}

\item{burn_in}{Integer. Number of initial draws discarded (default \code{1000}).}

\item{scale_X}{Logical. If \code{TRUE} (default), columns of \code{X_orig} are z-scored
before fitting; credible intervals are still reported on both the scaled and original scales.}

\item{ci_level}{Numeric in \eqn{(0,1)}. Credible interval level (default \code{0.95}).}
}
\value{
A list with components:
\itemize{
\item \code{posterior_chain}: Matrix of draws after burn-in (\code{iter} \eqn{\times} \eqn{p}).
\item \code{posterior_means}: Posterior means (length \eqn{p}).
\item \code{se_estimates}: Posterior standard deviations (length \eqn{p}).
\item \code{acceptance_rate}: Overall MH acceptance rate.
\item \code{prop_matched}: Posterior predictive check: proportion of observations
whose replicated outcomes match the observed more than 80\\% of the time.
\item \code{scaled_summary}: Data frame (including Intercept) with columns
\code{Mean}, \code{SD}, \code{CI_low}, \code{CI_high} in the working (logit/possibly scaled) space.
\item \code{standardized_coefs_back}: Data frame (per predictor) with means and CIs for:
\code{Scaled} (working space), and back-transformed effects on
\code{b_A_original}, \code{b_SAS_original}, \code{b_Long_original}.
\item \code{scaling_info}: List with \code{scale_X} flag and centering/scaling vectors (if used).
\item \code{ci_level}: Credible interval level used.
}
}
\description{
Run a simple random-walk Metropolis–Hastings sampler for a logistic model
with a Multivariate Exponential Power (MEP) prior on the coefficient vector.
Predictors can be optionally z-scored before fitting. The function returns
posterior draws (after burn-in), summary stats in the working (logit/scaled)
space, back-transformed coefficients to the original predictor scale, and
Bayesian credible intervals for all reported effects.
}
\details{
The MEP prior is proportional to \eqn{\exp\{-\tfrac12 ( ( \beta-\mu )^\top \Sigma^{-1} (\beta-\mu) )^\kappa\}}.
When \code{scale_X=TRUE}, the logistic design used in the sampler is z-scored; all
reported “original-scale” effects are computed by back-transforming the draws.

Back-transformed effect scales:
\itemize{
\item \strong{A}: per–SD-on-\code{X_orig} effect on the log-odds scale.
\item \strong{SAS}: \code{A} multiplied by \eqn{\pi/\sqrt{3}}.
\item \strong{Long}: \code{A} multiplied by \eqn{\pi/\sqrt{3} + 1}.
}
}
\examples{
\donttest{
set.seed(1)
y <- c(0,0,0,0,1,1,1,1)
X <- cbind(
  X1 = c(-1.86, -0.81,  1.32, -0.40,  0.91,  2.49,  0.34,  0.25),
  X2 = c( 0.52,  1.07,  0.60,  0.67, -1.39,  0.16, -1.40, -0.09)
)
p <- ncol(X) + 1
fit <- MEP_latent(
  n_iter = 10000, burn_in = 1000, init_beta = rep(0.01, p), step_size = 0.4,
  X_orig = X, y = y, mu = rep(0, p), Sigma = diag(p), kappa = 1,
  scale_X = TRUE, ci_level = 0.95
)
head(fit$scaled_summary)
head(fit$standardized_coefs_back)
}
}
\seealso{
\code{\link{mep_grid_search}}, \code{\link{latent_separation}}, \code{\link{uni_separation}}
}
