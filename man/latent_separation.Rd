% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Latent_separation.R
\name{latent_separation}
\alias{latent_separation}
\title{LP-based latent separation detection (with optional subset search)}
\usage{
latent_separation(
  y,
  X,
  test_combinations = FALSE,
  min_vars = 2,
  epsilon = 1e-05,
  only_perfect = FALSE,
  find_minimal = FALSE,
  mode = c("either", "perfect", "quasi"),
  max_vars = NULL,
  stop_at_first = FALSE,
  missing = c("complete", "impute"),
  impute_args = list(),
  scale_X = TRUE,
  tau_complete = 1e-06,
  eps_boundary = NULL,
  quasi_to_none_if = 0.5,
  missing_scope = c("global", "subset"),
  minimal_strategy = c("auto", "forward", "backward"),
  small_p_threshold = 15L,
  backward_exhaustive = FALSE
)
}
\arguments{
\item{y}{Binary outcome (0/1 or 2-level factor/character/logical).}

\item{X}{Matrix or data frame of predictors (columns = variables).}

\item{test_combinations}{If TRUE, test every subset of size >= min_vars.}

\item{min_vars}{Minimum subset size to consider (default 2).}

\item{epsilon}{Numeric scalar > 0. Legacy margin parameter; used as default for eps_boundary.}

\item{only_perfect}{Legacy flag for exhaustive mode (kept for compatibility).}

\item{find_minimal}{If TRUE, return separating subsets based on strategy.}

\item{mode}{One of "either", "perfect", or "quasi".}

\item{max_vars}{Optional upper bound on subset size (default all the way to p).}

\item{stop_at_first}{If TRUE, stop after the first minimal hit (forward or backward_exhaustive).}

\item{missing}{How to treat missing data: "complete" or "impute".}

\item{impute_args}{Optional list of imputation settings when missing="impute".}

\item{scale_X}{Logical; if TRUE, standardize encoded predictors with scale().}

\item{tau_complete}{Threshold on delta_hat to declare complete separation. Default 1e-6.}

\item{eps_boundary}{Target margin delta for severity LP. If NULL, defaults to epsilon.}

\item{quasi_to_none_if}{Numeric in (0,1]. If K_relax >= rho * n, quasi treated as none.}

\item{missing_scope}{"global" or "subset". Default "global".}

\item{minimal_strategy}{"auto","forward","backward". Default "auto".}

\item{small_p_threshold}{Threshold used by minimal_strategy="auto". Default 15.}

\item{backward_exhaustive}{If TRUE and strategy is backward, enumerate by size. Default FALSE.}
}
\value{
\itemize{
\item Single-set mode: list with fields type, satisfied, available_types, removed, message,
missing_info, diagnostics.
\item Exhaustive mode: named list of hits with type, vars, removed, missing_info, diagnostics.
\item Minimal mode: list with $minimal_subsets, each entry containing type, vars, idx, removed,
missing_info, diagnostics plus strategy metadata.
}
}
\description{
Detects latent (complete or quasi-complete) separation for a binary outcome
using linear programming in the multivariate space.
}
\details{
Two-stage pipeline:
Stage A: max-margin LP with L1 equality normalization to identify complete separation
Stage B: severity LP to compute multivariate severity lower bound K_relax

Notes:
\itemize{
\item Quasi is treated as non-substantive and labeled no separation when
K_relax / n is large (default quasi_to_none_if = 0.5) to reduce false positives.
\item Legacy row-deletion diagnostic for quasi is kept (removed indices), but does not
drive the quasi decision.
}

Missingness handling across subsets:
\itemize{
\item missing_scope = "global" (recommended): missing handling is done once on full X,
then reused for every subset so rows are fixed across subset evaluations.
\item missing_scope = "subset": missing handling is done per subset (legacy behavior).
}

Minimal subset search strategies:
\itemize{
\item minimal_strategy = "forward": enumerate increasing subset sizes (can be expensive)
\item minimal_strategy = "backward": scalable greedy backward elimination by default
\item minimal_strategy = "auto": forward if p <= small_p_threshold else backward
\item backward_exhaustive = TRUE: enumerate subsets by decreasing size p-1, p-2, ...
respecting eval_limit, can be expensive for moderate/large p.
}

Runtime controls for minimal search:
\itemize{
\item options(latent_separation.eval_limit = N)
\item options(latent_separation.show_progress = TRUE/FALSE)
\item options(latent_separation.progress_every = M)
}
}
