% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MEP.R
\name{mep_grid_search}
\alias{mep_grid_search}
\title{Grid search over MEP priors with automatic selection and CIs}
\usage{
mep_grid_search(
  y,
  X,
  n_iter = 10000,
  burn_in = 1000,
  init_beta = NULL,
  step_size = 0.4,
  mu_vals = seq(-1, 1, by = 0.1),
  Sigma_list = list(diag(ncol(X) + 1), diag(ncol(X) + 1) * 0.1, diag(ncol(X) + 1) * 0.5,
    diag(ncol(X) + 1) * 2, diag(ncol(X) + 1) * 5),
  kappa_vals = c(0.5, 1, 2),
  accept_window = c(0.3, 0.4),
  accept_target = 0.35,
  scale_X = TRUE,
  ci_level = 0.95
)
}
\arguments{
\item{y}{Binary outcome (0/1, logical, or 2-level factor/character).}

\item{X}{Matrix or data.frame of predictors (no intercept).}

\item{n_iter, burn_in, init_beta, step_size}{Passed to \code{\link{MEP_latent}}.}

\item{mu_vals}{Numeric vector; each value is repeated to length \eqn{p}
(intercept + predictors) to form \eqn{\mu}.}

\item{Sigma_list}{List of \eqn{p \times p} positive-definite matrices for the prior scale.}

\item{kappa_vals}{Numeric vector of positive \eqn{\kappa} values.}

\item{accept_window}{Numeric length-2 vector giving the acceptable MH acceptance-rate
window (default \code{c(0.3, 0.4)}).}

\item{accept_target}{Numeric. Target acceptance used to pick the closest run if
the window yields no candidates (default \code{0.35}).}

\item{scale_X}{Logical. If \code{TRUE} (default), predictors are z-scored before fitting.}

\item{ci_level}{Numeric in \eqn{(0,1)}. Credible interval level (default \code{0.95}).}
}
\value{
A list with:
\describe{
\item{\code{best_settings}}{List with chosen \code{mu}, \code{Sigma}, \code{kappa}.}
\item{\code{best_acceptance}}{Acceptance rate of the selected run.}
\item{\code{best_prop_matched}}{Posterior predictive “match” statistic of the selected run.}
\item{\code{posterior_means}}{Posterior means for the selected run.}
\item{\code{standardized_coefs_back}}{Data frame of back-transformed effects with CIs
(A / SAS / Long scales).}
\item{\code{scaled_summary}}{Data frame of working-space summaries with CIs (includes intercept).}
\item{\code{Ref_ratio}}{Character string of the GLM reference coefficient ratio (if available).}
\item{\code{results_table}}{Data frame summarizing all grid runs (acceptance, ratios, etc.).}
\item{\code{ci_level}}{Credible interval level used.}
}
}
\description{
Try a grid of prior settings \eqn{(\mu, \Sigma, \kappa)} for the MEP-regularized
logistic model, fit each via \code{\link{MEP_latent}}, and select a single
run using an acceptance-rate window and (if available) closeness to a GLM
coefficient-ratio reference. Credible intervals are carried through from the
selected run.
}
\examples{
\donttest{
set.seed(1)
y <- c(0,0,0,0,1,1,1,1)
X <- cbind(
  X1 = c(-1.86, -0.81,  1.32, -0.40,  0.91,  2.49,  0.34,  0.25),
  X2 = c( 0.52,  1.07,  0.60,  0.67, -1.39,  0.16, -1.40, -0.09)
)
gs <- mep_grid_search(y, X, n_iter = 10000, burn_in = 1000, scale_X = TRUE)
gs$best_settings
head(gs$standardized_coefs_back)
}
}
\seealso{
\code{\link{MEP_latent}}, \code{\link{latent_separation}}, \code{\link{uni_separation}}
}
